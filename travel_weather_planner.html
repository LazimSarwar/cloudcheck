<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CloudCheck - Travel & Tourism</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
      color: #2d3748;
      font-family: 'Inter', sans-serif;
      height: auto;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      position: relative;
      min-height: 100vh;
    }

    /* Navbar */
    .navbar {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 40px;
      z-index: 100;
      position: relative;
    }

    /* Logo */
    .logo {
      font-size: 2.5rem;
      font-weight: 700;
      background: #000;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      padding-left: 17%;
    }

    /* Nav links */
    .nav-links {
      display: flex;
      gap: 20px;
      align-items: center;
      padding-right: 17.5%;
      position: relative;
    }

    .nav-links a {
      color: #4a5568;
      text-decoration: none;
      font-size: 0.95rem;
      transition: color 0.3s ease;
      position: relative;
      cursor: pointer;
      font-weight: 500;
    }

    .nav-links a:hover {
      color: #000;
    }

    .nav-links a.active {
      color: #4facfe;
    }

    /* Resources Dropdown */
    .resources-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      backdrop-filter: blur(20px);
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      min-width: 250px;
      padding: 10px 0;
      z-index: 1000;
      display: none;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }

    .resources-dropdown.show {
      display: block;
      animation: dropdownFade 0.3s ease;
    }

    @keyframes dropdownFade {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .resource-item {
      padding: 12px 20px;
      color: #2d3748;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.3s ease;
      border-bottom: 1px solid #f7fafc;
    }

    .resource-item:hover {
      background: #f7fafc;
      transform: translateX(1px);
    }

    .resource-item:last-child {
      border-bottom: none;
    }

    .resource-icon {
      font-size: 1rem;
      color: #4299e1;
      width: 20px;
      text-align: center;
    }

    .resource-text {
      flex: 1;
    }

    .resource-desc {
      font-size: 0.8rem;
      color: #718096;
      margin-top: 2px;
    }

    /* Dashboard */
    .dashboard {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px;
      position: relative;
      z-index: 1;
    }

    .dashboard-card {
      width: 100%;
      max-width: 1600px;
      height: auto;
      min-height: 800px;
      background: white;
      border-radius: 20px;
      border: 1px solid #e2e8f0;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      padding: 30px;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }

    /* Dashboard Header */
    .dashboard-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .dashboard-title {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #6e5630 0%, #4b3808 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .dashboard-subtitle {
      font-size: 1.1rem;
      color: #4a5568;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.5;
    }

    /* Trip Planning Form */
    .trip-form {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-bottom: 30px;
      background: #f7fafc;
      border-radius: 15px;
      padding: 25px;
      border: 1px solid #e2e8f0;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
      position: relative;
    }

    .form-label {
      font-size: 0.95rem;
      font-weight: 500;
      color: #4a5568;
    }

    .form-input, .form-select {
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #cbd5e0;
      background: white;
      color: #2d3748;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-input:focus, .form-select:focus {
      outline: none;
      border-color: #4299e1;
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.15);
    }

    .form-input::placeholder {
      color: #a0aec0;
    }

    /* Location suggestions dropdown */
    .suggestions-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 0 0 8px 8px;
      max-height: 200px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .suggestion-item {
      padding: 12px 15px;
      cursor: pointer;
      border-bottom: 1px solid #f7fafc;
      transition: background 0.3s ease;
      color: #2d3748;
      background: white;
    }

    .suggestion-item:hover {
      background: #f7fafc;
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .form-btn {
      grid-column: 1 / -1;
      padding: 15px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(135deg, #5e3d18 0%, #542c04 100%);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 10px;
      font-size: 1rem;
    }

    .form-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(85, 48, 48, 0.4);
    }

    .form-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Quick Summary Section */
    .quick-summary {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-bottom: 30px;
    }

    .summary-card {
      background: white;
      border-radius: 15px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      border: 1px solid #e2e8f0;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .summary-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .summary-header {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .summary-icon {
      font-size: 1.5rem;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(79, 172, 254, 0.15);
      color: #4299e1;
    }

    .summary-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #2d3748;
    }

    .summary-value {
      font-size: 1.8rem;
      font-weight: 700;
    }

    .summary-description {
      font-size: 0.9rem;
      color: #4a5568;
      line-height: 1.5;
    }

    /* Activity Panels */
    .activity-panels {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-bottom: 30px;
    }

    .activity-panel {
      background: white;
      border-radius: 15px;
      padding: 25px;
      border: 1px solid #e2e8f0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .activity-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }

    .activity-icon {
      font-size: 2rem;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(79, 172, 254, 0.1);
      color: #4299e1;
    }

    .activity-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #2d3748;
    }

    .activity-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .activity-metrics {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .metric-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid #f7fafc;
    }

    .metric-name {
      font-size: 0.95rem;
      color: #4a5568;
    }

    .metric-value {
      font-weight: 600;
      color: #2d3748;
    }

    .metric-value.safe { color: #38a169; }
    .metric-value.warning { color: #dd6b20; }
    .metric-value.danger { color: #e53e3e; }

    .activity-ai {
      background: rgba(79, 172, 254, 0.05);
      border-radius: 10px;
      padding: 20px;
      border-left: 4px solid #4299e1;
    }

    .ai-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 10px;
      color: #2d3748;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .ai-title i {
      color: #4299e1;
    }

    .ai-suggestion {
      font-size: 0.95rem;
      color: #4a5568;
      line-height: 1.5;
    }

    /* Map Section */
    .map-section {
      background: white;
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 30px;
      height: 400px;
      border: 1px solid #e2e8f0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .map-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      color: #2d3748;
    }

    .map-title i {
      color: #4299e1;
    }

    #travelMap {
      height: 320px;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid #e2e8f0;
    }

    /* Travel Safety Section */
    .travel-safety {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-bottom: 30px;
    }

    .safety-container {
      background: white;
      border-radius: 15px;
      padding: 20px;
      height: 300px;
      border: 1px solid #e2e8f0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .safety-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      color: #2d3748;
    }

    .safety-title i {
      color: #4299e1;
    }

    .safety-list {
      height: 230px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .safety-card {
      background: #f7fafc;
      border-radius: 10px;
      padding: 15px;
      display: flex;
      align-items: center;
      gap: 15px;
      transition: all 0.3s ease;
      cursor: pointer;
      border: 1px solid #e2e8f0;
    }

    .safety-card:hover {
      background: white;
      transform: translateX(5px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
    }

    .safety-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(76, 175, 80, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #38a169;
    }

    .safety-info {
      flex: 1;
    }

    .safety-name {
      font-weight: 600;
      margin-bottom: 5px;
      color: #2d3748;
    }

    .safety-details {
      font-size: 0.85rem;
      color: #718096;
    }

    .safety-distance {
      font-weight: 600;
      color: #38a169;
    }

    /* Packing Checklist */
    .packing-checklist {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      border: 1px solid #e2e8f0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .checklist-title {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      color: #2d3748;
    }

    .checklist-title i {
      color: #4299e1;
    }

    .checklist-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
    }

    .checklist-item {
      background: #f7fafc;
      border-radius: 12px;
      padding: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.3s ease;
      cursor: pointer;
      border: 1px solid #e2e8f0;
    }

    .checklist-item:hover {
      transform: translateY(-3px);
      background: white;
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }

    .checklist-icon {
      font-size: 1.2rem;
      color: #4299e1;
    }

    .checklist-name {
      font-size: 1rem;
      font-weight: 500;
      color: #2d3748;
    }

    /* Data Source Info */
    .data-source {
      margin-top: 20px;
      padding: 15px;
      background: rgba(66, 153, 225, 0.1);
      border-radius: 10px;
      font-size: 0.9rem;
      color: #4a5568;
      text-align: center;
      border: 1px solid rgba(66, 153, 225, 0.2);
    }

    /* Loading State */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 300px;
      flex-direction: column;
      gap: 20px;
      grid-column: 1 / -1;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #e2e8f0;
      border-top: 5px solid #553030;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Error State */
    .error-state {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 300px;
      flex-direction: column;
      gap: 20px;
      text-align: center;
      grid-column: 1 / -1;
    }

    .error-icon {
      font-size: 4rem;
      color: #e53e3e;
      margin-bottom: 20px;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
      .trip-form {
        grid-template-columns: 1fr 1fr;
      }
      .quick-summary {
        grid-template-columns: 1fr;
      }
      .activity-panels {
        grid-template-columns: 1fr;
      }
      .travel-safety {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .dashboard-card {
        padding: 20px;
      }
      .navbar {
        padding: 20px;
        flex-direction: column;
        gap: 15px;
      }
      .logo {
        padding-left: 0;
      }
      .nav-links {
        padding-right: 0;
      }
      .resources-dropdown {
        left: -50px;
        min-width: 200px;
      }
      .trip-form {
        grid-template-columns: 1fr;
      }
      .activity-content {
        grid-template-columns: 1fr;
      }
      .checklist-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <div class="navbar">
    <div class="logo">cloudcheck</div>
    <div class="nav-links">
      <a href="#" id="resourcesLink">Resources <i class="fas fa-chevron-down" style="font-size: 0.8rem; margin-left: 5px;"></i></a>
      <div class="resources-dropdown" id="resourcesDropdown">
        <a href="https://power.larc.nasa.gov/" class="resource-item" target="_blank">
          <i class="fas fa-satellite resource-icon"></i>
          <div class="resource-text">
            <div>NASA POWER API</div>
            <div class="resource-desc">Weather & solar data</div>
          </div>
        </a>
        <a href="https://gpm.nasa.gov/" class="resource-item" target="_blank">
          <i class="fas fa-cloud-rain resource-icon"></i>
          <div class="resource-text">
            <div>GPM IMERG</div>
            <div class="resource-desc">Precipitation data</div>
          </div>
        </a>
        <a href="https://worldview.earthdata.nasa.gov/" class="resource-item" target="_blank">
          <i class="fas fa-globe resource-icon"></i>
          <div class="resource-text">
            <div>NASA Worldview</div>
            <div class="resource-desc">Satellite imagery</div>
          </div>
        </a>
        <a href="https://open-meteo.com/" class="resource-item" target="_blank">
          <i class="fas fa-wind resource-icon"></i>
          <div class="resource-text">
            <div>Open-Meteo API</div>
            <div class="resource-desc">Weather forecasts</div>
          </div>
        </a>
        <a href="https://api.bigdatacloud.net/" class="resource-item" target="_blank">
          <i class="fas fa-map-marker-alt resource-icon"></i>
          <div class="resource-text">
            <div>BigDataCloud</div>
            <div class="resource-desc">Geocoding services</div>
          </div>
        </a>
        <a href="https://github.com/your-repo" class="resource-item" target="_blank">
          <i class="fab fa-github resource-icon"></i>
          <div class="resource-text">
            <div>Project GitHub</div>
            <div class="resource-desc">Source code & docs</div>
          </div>
        </a>
      </div>
      <a href="index.html">Live Weather</a>
      <a href="weather.html">Event Planner</a>
      <a href="emergency.html">Emergency</a>
      <a href="#" class="active">Travel</a>
      <a href="login.html">Account</a>
    </div>
  </div>

  <!-- Dashboard Section -->
  <div class="dashboard">
    <div class="dashboard-card">
      <!-- Dashboard Header -->
      <div class="dashboard-header">
        <h1 class="dashboard-title">Travel & Tourism Weather Guide</h1>
        <p class="dashboard-subtitle">Get personalized weather insights and safety recommendations for your travel activities</p>
      </div>
      
      <!-- Trip Planning Form -->
      <div class="trip-form" id="tripForm">
        <div class="form-group">
          <label class="form-label" for="destination">Destination</label>
          <input type="text" class="form-input" id="destination" placeholder="Enter city or location">
          <div class="suggestions-dropdown" id="locationSuggestions"></div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="tripDate">Trip Date</label>
          <input type="date" class="form-input" id="tripDate">
        </div>
        
        <div class="form-group">
          <label class="form-label" for="tripType">Trip Type</label>
          <select class="form-select" id="tripType">
            <option value="">Select trip type</option>
            <option value="beach">Beach Trip</option>
            <option value="mountain">Mountain Visit</option>
            <option value="boating">Boating / Fishing Trip</option>
            <option value="safari">Safari / Adventure Tour</option>
            <option value="city">City Tour / Sightseeing</option>
            <option value="photography">Outdoor Photography Session</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="tripDuration">Trip Duration</label>
          <select class="form-select" id="tripDuration">
            <option value="">Select duration</option>
            <option value="day">Day Trip</option>
            <option value="weekend">Weekend (2-3 days)</option>
            <option value="week">Week (5-7 days)</option>
            <option value="extended">Extended (1-2 weeks)</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="groupSize">Group Size</label>
          <select class="form-select" id="groupSize">
            <option value="">Select group size</option>
            <option value="solo">Solo Traveler</option>
            <option value="couple">Couple</option>
            <option value="family">Family (3-5)</option>
            <option value="group">Group (6+)</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="activityLevel">Activity Level</label>
          <select class="form-select" id="activityLevel">
            <option value="">Select activity level</option>
            <option value="relaxed">Relaxed / Leisurely</option>
            <option value="moderate">Moderate</option>
            <option value="active">Active / Adventurous</option>
            <option value="extreme">Extreme / Challenging</option>
          </select>
        </div>
        
        <button class="form-btn" id="planTripBtn">
          <i class="fas fa-plane"></i> Plan My Trip
        </button>
      </div>
      
      <!-- Quick Summary Section -->
      <div class="quick-summary" id="quickSummary" style="display: none;">
        <div class="summary-card">
          <div class="summary-header">
            <div class="summary-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="summary-title">Overall Suitability</div>
          </div>
          <div class="summary-value" id="overallSuitability">Good</div>
          <div class="summary-description" id="overallDescription">
            Weather conditions are favorable for your planned activities.
          </div>
        </div>
        
        <div class="summary-card">
          <div class="summary-header">
            <div class="summary-icon">
              <i class="fas fa-temperature-high"></i>
            </div>
            <div class="summary-title">Temperature</div>
          </div>
          <div class="summary-value" id="temperatureValue">24°C</div>
          <div class="summary-description" id="temperatureDescription">
            Comfortable for outdoor activities.
          </div>
        </div>
        
        <div class="summary-card">
          <div class="summary-header">
            <div class="summary-icon">
              <i class="fas fa-cloud-rain"></i>
            </div>
            <div class="summary-title">Rain Probability</div>
          </div>
          <div class="summary-value" id="rainProbability">15%</div>
          <div class="summary-description" id="rainDescription">
            Low chance of precipitation during your trip.
          </div>
        </div>
      </div>
      
      <!-- Activity Panels -->
      <div class="activity-panels" id="activityPanels" style="display: none;">
        <!-- Beach Trip Panel -->
        <div class="activity-panel" id="beachPanel">
          <div class="activity-header">
            <div class="activity-icon">
              <i class="fas fa-umbrella-beach"></i>
            </div>
            <div class="activity-title">Beach Trip</div>
          </div>
          <div class="activity-content">
            <div class="activity-metrics">
              <div class="metric-item">
                <span class="metric-name">UV Index</span>
                <span class="metric-value" id="beachUv">Moderate</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Wave Height</span>
                <span class="metric-value" id="beachWaves">0.5-1m</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Water Temp</span>
                <span class="metric-value" id="beachWaterTemp">22°C</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Thunderstorm Risk</span>
                <span class="metric-value warning" id="beachStormRisk">Low</span>
              </div>
            </div>
            <div class="activity-ai">
              <div class="ai-title">
                <i class="fas fa-robot"></i>
                AI Suggestion
              </div>
              <div class="ai-suggestion" id="beachAiSuggestion">
                Perfect beach day! UV levels are moderate until 2 PM. Safe for swimming all day. Best time for sunbathing: 10 AM - 3 PM.
              </div>
            </div>
          </div>
        </div>
        
        <!-- Mountain Visit Panel -->
        <div class="activity-panel" id="mountainPanel">
          <div class="activity-header">
            <div class="activity-icon">
              <i class="fas fa-mountain"></i>
            </div>
            <div class="activity-title">Mountain Visit</div>
          </div>
          <div class="activity-content">
            <div class="activity-metrics">
              <div class="metric-item">
                <span class="metric-name">Wind Chill</span>
                <span class="metric-value" id="mountainWindChill">18°C</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Visibility</span>
                <span class="metric-value" id="mountainVisibility">Good</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Trail Conditions</span>
                <span class="metric-value" id="mountainTrail">Dry</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Avalanche Risk</span>
                <span class="metric-value safe" id="mountainAvalanche">None</span>
              </div>
            </div>
            <div class="activity-ai">
              <div class="ai-title">
                <i class="fas fa-robot"></i>
                AI Suggestion
              </div>
              <div class="ai-suggestion" id="mountainAiSuggestion">
                Excellent hiking conditions. Carry a light jacket for higher elevations. Best trekking time: 8 AM - 4 PM.
              </div>
            </div>
          </div>
        </div>
        
        <!-- Boating Panel -->
        <div class="activity-panel" id="boatingPanel">
          <div class="activity-header">
            <div class="activity-icon">
              <i class="fas fa-ship"></i>
            </div>
            <div class="activity-title">Boating / Fishing</div>
          </div>
          <div class="activity-content">
            <div class="activity-metrics">
              <div class="metric-item">
                <span class="metric-name">Wind Speed</span>
                <span class="metric-value" id="boatingWind">12 km/h</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Wave Height</span>
                <span class="metric-value" id="boatingWaves">0.8-1.2m</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Fish Activity</span>
                <span class="metric-value" id="boatingFish">High</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Storm Risk</span>
                <span class="metric-value safe" id="boatingStorm">None</span>
              </div>
            </div>
            <div class="activity-ai">
              <div class="ai-title">
                <i class="fas fa-robot"></i>
                AI Suggestion
              </div>
              <div class="ai-suggestion" id="boatingAiSuggestion">
                Ideal boating conditions. Best fishing times: 5-8 AM and 6-8 PM. Water conditions safe for small boats.
              </div>
            </div>
          </div>
        </div>
        
        <!-- Safari Panel -->
        <div class="activity-panel" id="safariPanel">
          <div class="activity-header">
            <div class="activity-icon">
              <i class="fas fa-paw"></i>
            </div>
            <div class="activity-title">Safari / Adventure</div>
          </div>
          <div class="activity-content">
            <div class="activity-metrics">
              <div class="metric-item">
                <span class="metric-name">Heat Index</span>
                <span class="metric-value" id="safariHeat">26°C</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Animal Activity</span>
                <span class="metric-value" id="safariAnimals">High</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Route Safety</span>
                <span class="metric-value safe" id="safariRoutes">Good</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Flash Flood Risk</span>
                <span class="metric-value safe" id="safariFlood">None</span>
              </div>
            </div>
            <div class="activity-ai">
              <div class="ai-title">
                <i class="fas fa-robot"></i>
                AI Suggestion
              </div>
              <div class="ai-suggestion" id="safariAiSuggestion">
                Prime safari conditions! Best animal viewing: 6-10 AM and 4-7 PM. Carry sufficient water and sun protection.
              </div>
            </div>
          </div>
        </div>
        
        <!-- City Tour Panel -->
        <div class="activity-panel" id="cityPanel">
          <div class="activity-header">
            <div class="activity-icon">
              <i class="fas fa-city"></i>
            </div>
            <div class="activity-title">City Tour / Sightseeing</div>
          </div>
          <div class="activity-content">
            <div class="activity-metrics">
              <div class="metric-item">
                <span class="metric-name">Comfort Index</span>
                <span class="metric-value" id="cityComfort">Very Good</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Air Quality</span>
                <span class="metric-value" id="cityAir">Moderate</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Crowd Forecast</span>
                <span class="metric-value" id="cityCrowds">Medium</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Walking Comfort</span>
                <span class="metric-value safe" id="cityWalking">Excellent</span>
              </div>
            </div>
            <div class="activity-ai">
              <div class="ai-title">
                <i class="fas fa-robot"></i>
                AI Suggestion
              </div>
              <div class="ai-suggestion" id="cityAiSuggestion">
                Perfect day for exploring! Best sightseeing hours: 9 AM - 12 PM and 3 PM - 6 PM. Consider indoor attractions during midday heat.
              </div>
            </div>
          </div>
        </div>
        
        <!-- Photography Panel -->
        <div class="activity-panel" id="photographyPanel">
          <div class="activity-header">
            <div class="activity-icon">
              <i class="fas fa-camera"></i>
            </div>
            <div class="activity-title">Outdoor Photography</div>
          </div>
          <div class="activity-content">
            <div class="activity-metrics">
              <div class="metric-item">
                <span class="metric-name">Golden Hour</span>
                <span class="metric-value" id="photoGolden">6:15-7:15 PM</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Cloud Coverage</span>
                <span class="metric-value" id="photoClouds">30%</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Visibility</span>
                <span class="metric-value" id="photoVisibility">Excellent</span>
              </div>
              <div class="metric-item">
                <span class="metric-name">Drone Safety</span>
                <span class="metric-value safe" id="photoDrone">Good</span>
              </div>
            </div>
            <div class="activity-ai">
              <div class="ai-title">
                <i class="fas fa-robot"></i>
                AI Suggestion
              </div>
              <div class="ai-suggestion" id="photoAiSuggestion">
                Excellent photography conditions! Perfect sunset at 6:45 PM. Low wind - ideal for drone shots. Cloud coverage will create dramatic skies.
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Map Section -->
      <div class="map-section" id="mapSection" style="display: none;">
        <div class="map-title">
          <i class="fas fa-map-marked-alt"></i>
          Travel Map & Points of Interest
        </div>
        <div id="travelMap"></div>
      </div>
      
      <!-- Travel Safety Section -->
      <div class="travel-safety" id="travelSafety" style="display: none;">
        <div class="safety-container">
          <div class="safety-title">
            <i class="fas fa-shield-alt"></i>
            Emergency Services
          </div>
          <div class="safety-list" id="emergencyServicesList">
            <!-- Will be populated by JavaScript -->
          </div>
        </div>
        
        <div class="safety-container">
          <div class="safety-title">
            <i class="fas fa-info-circle"></i>
            Travel Advisories
          </div>
          <div class="safety-list" id="travelAdvisoriesList">
            <!-- Will be populated by JavaScript -->
          </div>
        </div>
      </div>
      
      <!-- Packing Checklist -->
      <div class="packing-checklist" id="packingChecklist" style="display: none;">
        <div class="checklist-title">
          <i class="fas fa-suitcase"></i>
          Packing Checklist
        </div>
        <div class="checklist-grid" id="checklistGrid">
          <!-- Will be populated by JavaScript -->
        </div>
      </div>
      
      <!-- Data Source Info -->
      <div class="data-source" id="dataSourceInfo" style="display: none;">
        <i class="fas fa-database"></i> Data sources: NASA POWER API, GPM IMERG, Open-Meteo API, Global Travel Advisories | Last updated: <span id="lastUpdated">Just now</span>
      </div>
      
      <!-- Loading State -->
      <div class="loading" id="loadingState">
        <div class="spinner"></div>
        <p>Planning Your Trip...</p>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // DOM Elements
      const tripForm = document.getElementById('tripForm');
      const quickSummary = document.getElementById('quickSummary');
      const activityPanels = document.getElementById('activityPanels');
      const mapSection = document.getElementById('mapSection');
      const travelSafety = document.getElementById('travelSafety');
      const packingChecklist = document.getElementById('packingChecklist');
      const dataSourceInfo = document.getElementById('dataSourceInfo');
      const loadingState = document.getElementById('loadingState');
      const planTripBtn = document.getElementById('planTripBtn');
      const resourcesLink = document.getElementById('resourcesLink');
      const resourcesDropdown = document.getElementById('resourcesDropdown');
      const lastUpdated = document.getElementById('lastUpdated');
      const destination = document.getElementById('destination');
      const locationSuggestions = document.getElementById('locationSuggestions');
      
      // Map variable
      let travelMap = null;
      let mapMarkers = [];
      
      // Resources dropdown functionality
      resourcesLink.addEventListener('click', function(e) {
        e.preventDefault();
        resourcesDropdown.classList.toggle('show');
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', function(e) {
        if (!resourcesLink.contains(e.target) && !resourcesDropdown.contains(e.target)) {
          resourcesDropdown.classList.remove('show');
        }
      });
      
      // Location input with suggestions
      let debounceTimer;
      destination.addEventListener('input', function() {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => {
          const query = this.value.trim();
          if (query.length > 2) {
            fetchLocationSuggestions(query);
          } else {
            locationSuggestions.style.display = 'none';
          }
        }, 300);
      });
      
      // Hide suggestions when clicking outside
      document.addEventListener('click', function(e) {
        if (!destination.contains(e.target) && !locationSuggestions.contains(e.target)) {
          locationSuggestions.style.display = 'none';
        }
      });
      
      // Fetch location suggestions
      async function fetchLocationSuggestions(query) {
        try {
          const response = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(query)}&count=5`);
          const data = await response.json();
          
          if (data.results && data.results.length > 0) {
            showLocationSuggestions(data.results);
          } else {
            locationSuggestions.style.display = 'none';
          }
        } catch (error) {
          console.error('Error fetching location suggestions:', error);
          locationSuggestions.style.display = 'none';
        }
      }
      
      // Show location suggestions
      function showLocationSuggestions(results) {
        locationSuggestions.innerHTML = '';
        results.forEach(result => {
          const item = document.createElement('div');
          item.className = 'suggestion-item';
          item.textContent = `${result.name}, ${result.country}`;
          item.addEventListener('click', () => {
            destination.value = `${result.name}, ${result.country}`;
            locationSuggestions.style.display = 'none';
          });
          locationSuggestions.appendChild(item);
        });
        locationSuggestions.style.display = 'block';
      }
      
      // Plan trip button click
      planTripBtn.addEventListener('click', function() {
        // Validate form
        const destinationVal = document.getElementById('destination').value;
        const tripDate = document.getElementById('tripDate').value;
        const tripType = document.getElementById('tripType').value;
        const tripDuration = document.getElementById('tripDuration').value;
        const groupSize = document.getElementById('groupSize').value;
        const activityLevel = document.getElementById('activityLevel').value;
        
        if (!destinationVal || !tripDate || !tripType) {
          alert('Please fill in destination, trip date, and trip type.');
          return;
        }
        
        // Show loading state
        loadingState.style.display = 'flex';
        quickSummary.style.display = 'none';
        activityPanels.style.display = 'none';
        mapSection.style.display = 'none';
        travelSafety.style.display = 'none';
        packingChecklist.style.display = 'none';
        dataSourceInfo.style.display = 'none';
        
        // Update last updated time
        lastUpdated.textContent = new Date().toLocaleString();
        
        // Process the trip planning
        processTripPlanning(destinationVal, tripDate, tripType, tripDuration, groupSize, activityLevel);
      });
      
      // Process trip planning
      async function processTripPlanning(destination, tripDate, tripType, tripDuration, groupSize, activityLevel) {
        try {
          // Get coordinates from destination
          const coords = await getCoordinates(destination);
          if (!coords) {
            throw new Error('Could not find destination coordinates');
          }
          
          // Initialize map
          initializeMap(coords.lat, coords.lon, destination);
          
          // Fetch weather data
          const weatherData = await fetchWeatherData(coords.lat, coords.lon, tripDate);
          
          // Fetch travel data
          const travelData = await fetchTravelData(coords.lat, coords.lon);
          
          // Process data and generate travel recommendations
          const analysis = processTravelData(
            destination, tripDate, tripType, tripDuration, groupSize, activityLevel, 
            weatherData, travelData, coords
          );
          
          // Update UI with results
          updateResultsUI(analysis);
          
          // Generate safety information
          generateSafetyInfo(analysis);
          
          // Generate packing checklist
          generatePackingChecklist(analysis);
          
          // Update map with points of interest
          updateMapWithPOIs(coords, analysis);
          
          // Hide loading and show results
          loadingState.style.display = 'none';
          quickSummary.style.display = 'grid';
          activityPanels.style.display = 'grid';
          mapSection.style.display = 'block';
          travelSafety.style.display = 'grid';
          packingChecklist.style.display = 'block';
          dataSourceInfo.style.display = 'block';

          // Recalculate map size
          setTimeout(() => {
            if (travelMap) {
              travelMap.invalidateSize();
            }
          }, 200);
          
        } catch (error) {
          console.error('Error processing trip planning:', error);
          loadingState.style.display = 'none';
          showErrorState('Failed to plan your trip. Please try again.');
        }
      }
      
      // Get coordinates from location name
      async function getCoordinates(location) {
        try {
          // Using OpenStreetMap Nominatim for geocoding (free)
          const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(location)}&limit=1`);
          const data = await response.json();
          
          if (data && data.length > 0) {
            return {
              lat: parseFloat(data[0].lat),
              lon: parseFloat(data[0].lon)
            };
          }
          return null;
        } catch (error) {
          console.error('Error getting coordinates:', error);
          return null;
        }
      }
      
      // Initialize Leaflet map
      function initializeMap(lat, lon, destination) {
        // Remove existing map if it exists
        if (travelMap) {
          travelMap.remove();
        }
        
        // Clear existing markers
        mapMarkers.forEach(marker => marker.remove());
        mapMarkers = [];
        
        // Create new map
        travelMap = L.map('travelMap').setView([lat, lon], 10);
        
        // Add tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          attribution: '© OpenStreetMap contributors'
        }).addTo(travelMap);
        
        // Add destination marker
        const destinationMarker = L.marker([lat, lon])
          .addTo(travelMap)
          .bindPopup(`<b>Your Destination</b><br>${destination}`)
          .openPopup();
        
        mapMarkers.push(destinationMarker);
      }
      
      // Update map with points of interest
      function updateMapWithPOIs(coords, analysis) {
        if (!travelMap) return;
        
        const { lat, lon } = coords;
        const tripType = analysis.tripType;
        
        // Define POIs based on trip type
        const pois = getPOIsByTripType(tripType, lat, lon);
        
        // Add POIs to map
        pois.forEach(poi => {
          const marker = L.marker([poi.lat, poi.lon])
            .addTo(travelMap)
            .bindPopup(`<b>${poi.name}</b><br>${poi.type}`);
          
          mapMarkers.push(marker);
        });
      }
      
      // Get POIs by trip type
      function getPOIsByTripType(tripType, lat, lon) {
        // In a real implementation, this would fetch from a POI database
        // For demo purposes, we'll return mock data
        const pois = [];
        
        switch(tripType) {
          case 'beach':
            pois.push(
              { name: 'Sandy Beach', type: 'Beach', lat: lat + 0.02, lon: lon + 0.02 },
              { name: 'Coral Reef', type: 'Snorkeling Spot', lat: lat + 0.01, lon: lon + 0.03 },
              { name: 'Beach Cafe', type: 'Restaurant', lat: lat + 0.03, lon: lon + 0.01 }
            );
            break;
          case 'mountain':
            pois.push(
              { name: 'Summit Trail', type: 'Hiking Trail', lat: lat + 0.02, lon: lon + 0.02 },
              { name: 'Mountain Lodge', type: 'Accommodation', lat: lat + 0.01, lon: lon + 0.01 },
              { name: 'Scenic Overlook', type: 'Viewpoint', lat: lat + 0.03, lon: lon + 0.03 }
            );
            break;
          case 'boating':
            pois.push(
              { name: 'Marina', type: 'Boat Rental', lat: lat + 0.02, lon: lon + 0.02 },
              { name: 'Fishing Spot', type: 'Fishing Area', lat: lat + 0.01, lon: lon + 0.03 },
              { name: 'Island', type: 'Destination', lat: lat + 0.03, lon: lon + 0.04 }
            );
            break;
          case 'safari':
            pois.push(
              { name: 'Wildlife Reserve', type: 'Safari Park', lat: lat + 0.02, lon: lon + 0.02 },
              { name: 'Watering Hole', type: 'Animal Viewing', lat: lat + 0.01, lon: lon + 0.01 },
              { name: 'Ranger Station', type: 'Information', lat: lat + 0.03, lon: lon + 0.03 }
            );
            break;
          case 'city':
            pois.push(
              { name: 'Historic District', type: 'Sightseeing', lat: lat + 0.02, lon: lon + 0.02 },
              { name: 'Museum', type: 'Cultural', lat: lat + 0.01, lon: lon + 0.01 },
              { name: 'Shopping District', type: 'Shopping', lat: lat + 0.03, lon: lon + 0.03 }
            );
            break;
          case 'photography':
            pois.push(
              { name: 'Sunset Point', type: 'Photography Spot', lat: lat + 0.02, lon: lon + 0.02 },
              { name: 'Historic Bridge', type: 'Architecture', lat: lat + 0.01, lon: lon + 0.01 },
              { name: 'Botanical Garden', type: 'Nature', lat: lat + 0.03, lon: lon + 0.03 }
            );
            break;
        }
        
        return pois;
      }
      
      // Fetch weather data
      async function fetchWeatherData(lat, lon, tripDate) {
        try {
          // Calculate days from today to trip date
          const today = new Date();
          const trip = new Date(tripDate);
          const diffTime = Math.abs(trip - today);
          const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
          
          // For demo purposes, we'll use current weather
          // In a real implementation, you would use forecast data based on diffDays
          const response = await fetch(
            `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,precipitation,weather_code,wind_speed_10m,wind_gusts_10m,uv_index&daily=precipitation_probability_max,temperature_2m_max,temperature_2m_min,uv_index_max&timezone=auto`
          );
          
          if (!response.ok) {
            throw new Error('Weather API request failed');
          }
          
          const data = await response.json();
          return data;
          
        } catch (error) {
          console.error('Error fetching weather data:', error);
          // Return mock data as fallback
          return generateMockWeatherData();
        }
      }
      
      // Generate mock weather data (fallback)
      function generateMockWeatherData() {
        return {
          current: {
            temperature_2m: 24,
            relative_humidity_2m: 65,
            precipitation: 0,
            weather_code: 0,
            wind_speed_10m: 12,
            wind_gusts_10m: 18,
            uv_index: 5
          },
          daily: {
            precipitation_probability_max: [15],
            temperature_2m_max: [26],
            temperature_2m_min: [18],
            uv_index_max: [6]
          }
        };
      }
      
      // Fetch travel data
      async function fetchTravelData(lat, lon) {
        try {
          // In a real implementation, this would fetch from travel advisory APIs
          // For demo purposes, we'll return mock data
          return generateMockTravelData();
        } catch (error) {
          console.error('Error fetching travel data:', error);
          return generateMockTravelData();
        }
      }
      
      // Generate mock travel data
      function generateMockTravelData() {
        return {
          advisories: [
            { type: 'health', message: 'High UV index expected. Use sunscreen.' },
            { type: 'safety', message: 'Beach currents may be strong in the afternoon.' },
            { type: 'cultural', message: 'Respect local customs and dress codes.' }
          ],
          services: [
            { name: 'Central Hospital', type: 'Medical', distance: '3.2 km' },
            { name: 'Tourist Police', type: 'Police', distance: '1.5 km' },
            { name: 'Embassy', type: 'Diplomatic', distance: '5.1 km' },
            { name: 'Tourist Information', type: 'Information', distance: '0.8 km' }
          ]
        };
      }
      
      // Process travel data
      function processTravelData(destination, tripDate, tripType, tripDuration, groupSize, activityLevel, weatherData, travelData, coords) {
        // Calculate suitability scores based on data
        
        // Overall suitability (higher is better)
        let overallSuitability = 0.8;
        
        // Weather suitability
        let weatherSuitability = 0.9;
        if (weatherData.current.precipitation > 5) weatherSuitability = 0.6;
        if (weatherData.current.wind_speed_10m > 30) weatherSuitability = 0.7;
        if (weatherData.daily.precipitation_probability_max[0] > 50) weatherSuitability = 0.5;
        
        // Activity-specific suitability
        let activitySuitability = calculateActivitySuitability(tripType, weatherData);
        
        // Calculate overall suitability (weighted average)
        overallSuitability = (weatherSuitability * 0.4 + activitySuitability * 0.6);
        
        return {
          destination,
          tripDate,
          tripType,
          tripDuration,
          groupSize,
          activityLevel,
          coords,
          suitability: {
            overall: overallSuitability,
            weather: weatherSuitability,
            activity: activitySuitability
          },
          weatherData,
          travelData
        };
      }
      
      // Calculate activity-specific suitability
      function calculateActivitySuitability(tripType, weatherData) {
        let suitability = 0.8;
        
        switch(tripType) {
          case 'beach':
            if (weatherData.current.uv_index > 8) suitability = 0.6;
            if (weatherData.current.wind_speed_10m > 25) suitability = 0.7;
            if (weatherData.daily.precipitation_probability_max[0] > 30) suitability = 0.5;
            break;
          case 'mountain':
            if (weatherData.current.temperature_2m < 5) suitability = 0.6;
            if (weatherData.current.wind_speed_10m > 40) suitability = 0.5;
            if (weatherData.daily.precipitation_probability_max[0] > 50) suitability = 0.4;
            break;
          case 'boating':
            if (weatherData.current.wind_speed_10m > 20) suitability = 0.6;
            if (weatherData.current.wind_gusts_10m > 35) suitability = 0.4;
            if (weatherData.daily.precipitation_probability_max[0] > 40) suitability = 0.5;
            break;
          case 'safari':
            if (weatherData.current.temperature_2m > 35) suitability = 0.6;
            if (weatherData.daily.precipitation_probability_max[0] > 60) suitability = 0.5;
            break;
          case 'city':
            if (weatherData.daily.precipitation_probability_max[0] > 70) suitability = 0.6;
            if (weatherData.current.temperature_2m > 32) suitability = 0.7;
            break;
          case 'photography':
            if (weatherData.daily.precipitation_probability_max[0] > 50) suitability = 0.5;
            if (weatherData.current.wind_speed_10m > 25) suitability = 0.6;
            break;
        }
        
        return suitability;
      }
      
      // Update results UI
      function updateResultsUI(analysis) {
        const suitability = analysis.suitability;
        const weatherData = analysis.weatherData;
        const tripType = analysis.tripType;
        
        // Update overall suitability
        const overallSuitabilityElement = document.getElementById('overallSuitability');
        const overallDescriptionElement = document.getElementById('overallDescription');
        
        let overallText = 'Excellent';
        let overallDescription = 'Perfect conditions for your planned activities.';
        
        if (suitability.overall > 0.7) {
          overallText = 'Good';
          overallDescription = 'Weather conditions are favorable for your planned activities.';
        } else if (suitability.overall > 0.5) {
          overallText = 'Moderate';
          overallDescription = 'Some weather factors may affect your plans. Check specific activity details.';
        } else {
          overallText = 'Poor';
          overallDescription = 'Weather conditions are not ideal for your planned activities. Consider rescheduling.';
        }
        
        overallSuitabilityElement.textContent = overallText;
        overallDescriptionElement.textContent = overallDescription;
        
        // Update temperature
        document.getElementById('temperatureValue').textContent = `${weatherData.current.temperature_2m}°C`;
        document.getElementById('temperatureDescription').textContent = getTemperatureDescription(weatherData.current.temperature_2m);
        
        // Update rain probability
        document.getElementById('rainProbability').textContent = `${weatherData.daily.precipitation_probability_max[0]}%`;
        document.getElementById('rainDescription').textContent = getRainDescription(weatherData.daily.precipitation_probability_max[0]);
        
        // Update activity-specific panels
        updateActivityPanels(analysis);
      }
      
      // Get temperature description
      function getTemperatureDescription(temp) {
        if (temp < 10) return 'Cold. Dress warmly.';
        if (temp < 20) return 'Cool. Light jacket recommended.';
        if (temp < 28) return 'Comfortable for outdoor activities.';
        if (temp < 35) return 'Warm. Stay hydrated.';
        return 'Hot. Limit outdoor exposure.';
      }
      
      // Get rain description
      function getRainDescription(probability) {
        if (probability < 20) return 'Low chance of precipitation during your trip.';
        if (probability < 50) return 'Some chance of rain. Have a backup plan.';
        if (probability < 80) return 'Likely rain. Consider indoor alternatives.';
        return 'High probability of rain. Postpone outdoor activities if possible.';
      }
      
      // Update activity panels
      function updateActivityPanels(analysis) {
        const tripType = analysis.tripType;
        const weatherData = analysis.weatherData;
        
        // Show all panels but highlight the selected trip type
        const panels = ['beach', 'mountain', 'boating', 'safari', 'city', 'photography'];
        panels.forEach(panel => {
          const panelElement = document.getElementById(`${panel}Panel`);
          if (panel === tripType) {
            panelElement.style.display = 'block';
            panelElement.style.border = '2px solid #4299e1';
          } else {
            panelElement.style.display = 'block';
            panelElement.style.border = '1px solid #e2e8f0';
          }
        });
        
        // Update panel data based on weather
        updateBeachPanel(weatherData);
        updateMountainPanel(weatherData);
        updateBoatingPanel(weatherData);
        updateSafariPanel(weatherData);
        updateCityPanel(weatherData);
        updatePhotographyPanel(weatherData);
      }
      
      // Update beach panel
      function updateBeachPanel(weatherData) {
        document.getElementById('beachUv').textContent = getUvLevel(weatherData.current.uv_index);
        document.getElementById('beachWaves').textContent = getWaveHeight(weatherData.current.wind_speed_10m);
        document.getElementById('beachWaterTemp').textContent = `${Math.round(weatherData.current.temperature_2m * 0.8)}°C`;
        document.getElementById('beachStormRisk').textContent = getStormRisk(weatherData.daily.precipitation_probability_max[0]);
        
        // AI suggestion
        let suggestion = 'Good beach conditions. ';
        if (weatherData.current.uv_index > 6) {
          suggestion += 'High UV index - use sunscreen and limit sun exposure between 11 AM and 3 PM. ';
        }
        if (weatherData.current.wind_speed_10m > 20) {
          suggestion += 'Windy conditions - secure beach items. ';
        }
        if (weatherData.daily.precipitation_probability_max[0] > 30) {
          suggestion += 'Chance of rain later - have a backup plan. ';
        } else {
          suggestion += 'Low rain probability - perfect beach day!';
        }
        
        document.getElementById('beachAiSuggestion').textContent = suggestion;
      }
      
      // Update mountain panel
      function updateMountainPanel(weatherData) {
        const windChill = calculateWindChill(weatherData.current.temperature_2m, weatherData.current.wind_speed_10m);
        document.getElementById('mountainWindChill').textContent = `${windChill}°C`;
        document.getElementById('mountainVisibility').textContent = getVisibility(weatherData.current.weather_code);
        document.getElementById('mountainTrail').textContent = getTrailCondition(weatherData.daily.precipitation_probability_max[0]);
        document.getElementById('mountainAvalanche').textContent = 'None'; // Simplified for demo
        
        // AI suggestion
        let suggestion = 'Good hiking conditions. ';
        if (windChill < 10) {
          suggestion += 'Cool temperatures - dress in layers. ';
        }
        if (weatherData.current.wind_speed_10m > 25) {
          suggestion += 'Windy at higher elevations - be cautious on exposed trails. ';
        }
        if (weatherData.daily.precipitation_probability_max[0] > 40) {
          suggestion += 'Rain possible - bring waterproof gear. ';
        }
        suggestion += 'Best trekking time: 8 AM - 4 PM.';
        
        document.getElementById('mountainAiSuggestion').textContent = suggestion;
      }
      
      // Update boating panel
      function updateBoatingPanel(weatherData) {
        document.getElementById('boatingWind').textContent = `${weatherData.current.wind_speed_10m} km/h`;
        document.getElementById('boatingWaves').textContent = getWaveHeight(weatherData.current.wind_speed_10m);
        document.getElementById('boatingFish').textContent = getFishActivity(weatherData.current.temperature_2m, weatherData.current.precipitation);
        document.getElementById('boatingStorm').textContent = getStormRisk(weatherData.daily.precipitation_probability_max[0]);
        
        // AI suggestion
        let suggestion = 'Good boating conditions. ';
        if (weatherData.current.wind_speed_10m > 20) {
          suggestion += 'Moderate winds - suitable for experienced boaters only. ';
        }
        if (weatherData.daily.precipitation_probability_max[0] > 30) {
          suggestion += 'Rain possible - check weather updates frequently. ';
        }
        suggestion += 'Best fishing times: 5-8 AM and 6-8 PM.';
        
        document.getElementById('boatingAiSuggestion').textContent = suggestion;
      }
      
      // Update safari panel
      function updateSafariPanel(weatherData) {
        const heatIndex = calculateHeatIndex(weatherData.current.temperature_2m, weatherData.current.relative_humidity_2m);
        document.getElementById('safariHeat').textContent = `${heatIndex}°C`;
        document.getElementById('safariAnimals').textContent = getAnimalActivity(weatherData.current.temperature_2m);
        document.getElementById('safariRoutes').textContent = 'Good';
        document.getElementById('safariFlood').textContent = 'None';
        
        // AI suggestion
        let suggestion = 'Good safari conditions. ';
        if (heatIndex > 30) {
          suggestion += 'Hot conditions - stay hydrated and take breaks. ';
        }
        suggestion += 'Best animal viewing: 6-10 AM and 4-7 PM. ';
        suggestion += 'Carry sufficient water and sun protection.';
        
        document.getElementById('safariAiSuggestion').textContent = suggestion;
      }
      
      // Update city panel
      function updateCityPanel(weatherData) {
        document.getElementById('cityComfort').textContent = getComfortLevel(weatherData.current.temperature_2m, weatherData.current.relative_humidity_2m);
        document.getElementById('cityAir').textContent = 'Moderate'; // Simplified for demo
        document.getElementById('cityCrowds').textContent = getCrowdLevel();
        document.getElementById('cityWalking').textContent = getWalkingComfort(weatherData.current.temperature_2m, weatherData.daily.precipitation_probability_max[0]);
        
        // AI suggestion
        let suggestion = 'Good conditions for city exploration. ';
        if (weatherData.current.temperature_2m > 28) {
          suggestion += 'Warm weather - plan indoor activities during midday heat. ';
        }
        if (weatherData.daily.precipitation_probability_max[0] > 40) {
          suggestion += 'Rain possible - have umbrella handy. ';
        }
        suggestion += 'Best sightseeing hours: 9 AM - 12 PM and 3 PM - 6 PM.';
        
        document.getElementById('cityAiSuggestion').textContent = suggestion;
      }
      
      // Update photography panel
      function updatePhotographyPanel(weatherData) {
        document.getElementById('photoGolden').textContent = calculateGoldenHour();
        document.getElementById('photoClouds').textContent = `${getCloudCoverage(weatherData.current.weather_code)}%`;
        document.getElementById('photoVisibility').textContent = getVisibility(weatherData.current.weather_code);
        document.getElementById('photoDrone').textContent = getDroneSafety(weatherData.current.wind_speed_10m);
        
        // AI suggestion
        let suggestion = 'Good photography conditions. ';
        const cloudCoverage = getCloudCoverage(weatherData.current.weather_code);
        if (cloudCoverage > 70) {
          suggestion += 'Heavy cloud cover - good for dramatic landscapes but limited golden hour. ';
        } else if (cloudCoverage > 30) {
          suggestion += 'Partial clouds - perfect for interesting skies. ';
        } else {
          suggestion += 'Clear skies - great for sunrise/sunset shots. ';
        }
        if (weatherData.current.wind_speed_10m < 15) {
          suggestion += 'Low wind - ideal for drone photography. ';
        }
        suggestion += `Perfect sunset at ${calculateSunsetTime()}.`;
        
        document.getElementById('photoAiSuggestion').textContent = suggestion;
      }
      
      // Helper functions for weather calculations
      function getUvLevel(uvIndex) {
        if (uvIndex < 3) return 'Low';
        if (uvIndex < 6) return 'Moderate';
        if (uvIndex < 8) return 'High';
        if (uvIndex < 11) return 'Very High';
        return 'Extreme';
      }
      
      function getWaveHeight(windSpeed) {
        if (windSpeed < 10) return '0.2-0.5m';
        if (windSpeed < 20) return '0.5-1m';
        if (windSpeed < 30) return '1-1.5m';
        if (windSpeed < 40) return '1.5-2.5m';
        return '2.5m+';
      }
      
      function getStormRisk(rainProbability) {
        if (rainProbability < 20) return 'None';
        if (rainProbability < 50) return 'Low';
        if (rainProbability < 80) return 'Moderate';
        return 'High';
      }
      
      function calculateWindChill(temp, windSpeed) {
        // Simplified wind chill calculation
        return Math.round(temp - (windSpeed * 0.7));
      }
      
      function getVisibility(weatherCode) {
        // Simplified based on weather code
        if (weatherCode < 10) return 'Excellent';
        if (weatherCode < 30) return 'Good';
        if (weatherCode < 50) return 'Moderate';
        return 'Poor';
      }
      
      function getTrailCondition(rainProbability) {
        if (rainProbability < 20) return 'Dry';
        if (rainProbability < 50) return 'Mostly Dry';
        if (rainProbability < 80) return 'Wet in Spots';
        return 'Wet/Muddy';
      }
      
      function getFishActivity(temp, precipitation) {
        if (precipitation > 0) return 'High';
        if (temp > 15 && temp < 25) return 'High';
        return 'Moderate';
      }
      
      function calculateHeatIndex(temp, humidity) {
        // Simplified heat index calculation
        return Math.round(temp + (humidity / 100) * 5);
      }
      
      function getAnimalActivity(temp) {
        if (temp > 15 && temp < 28) return 'High';
        return 'Moderate';
      }
      
      function getComfortLevel(temp, humidity) {
        const discomfort = Math.abs(temp - 22) + (humidity > 70 ? 5 : 0);
        if (discomfort < 5) return 'Excellent';
        if (discomfort < 10) return 'Very Good';
        if (discomfort < 15) return 'Good';
        if (discomfort < 20) return 'Fair';
        return 'Poor';
      }
      
      function getCrowdLevel() {
        // Simplified - in real app would consider day of week, holidays, etc.
        const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const today = new Date().getDay();
        return (today === 0 || today === 6) ? 'High' : 'Medium';
      }
      
      function getWalkingComfort(temp, rainProbability) {
        if (rainProbability > 50) return 'Poor';
        if (temp > 32 || temp < 5) return 'Fair';
        return 'Excellent';
      }
      
      function calculateGoldenHour() {
        // Simplified - in real app would calculate based on location and date
        return '6:15-7:15 PM';
      }
      
      function getCloudCoverage(weatherCode) {
        // Simplified based on weather code
        if (weatherCode < 10) return 10;
        if (weatherCode < 30) return 30;
        if (weatherCode < 50) return 70;
        return 90;
      }
      
      function getDroneSafety(windSpeed) {
        if (windSpeed < 15) return 'Good';
        if (windSpeed < 25) return 'Moderate';
        return 'Poor';
      }
      
      function calculateSunsetTime() {
        // Simplified - in real app would calculate based on location and date
        return '6:45 PM';
      }
      
      // Generate safety information
      function generateSafetyInfo(analysis) {
        const travelData = analysis.travelData;
        const emergencyServicesList = document.getElementById('emergencyServicesList');
        const travelAdvisoriesList = document.getElementById('travelAdvisoriesList');
        
        emergencyServicesList.innerHTML = '';
        travelAdvisoriesList.innerHTML = '';
        
        // Add emergency services
        travelData.services.forEach(service => {
          const serviceCard = document.createElement('div');
          serviceCard.className = 'safety-card';
          serviceCard.innerHTML = `
            <div class="safety-icon">
              <i class="fas fa-${getServiceIcon(service.type)}"></i>
            </div>
            <div class="safety-info">
              <div class="safety-name">${service.name}</div>
              <div class="safety-details">${service.type} • <span class="safety-distance">${service.distance}</span></div>
            </div>
          `;
          emergencyServicesList.appendChild(serviceCard);
        });
        
        // Add travel advisories
        travelData.advisories.forEach(advisory => {
          const advisoryCard = document.createElement('div');
          advisoryCard.className = 'safety-card';
          advisoryCard.innerHTML = `
            <div class="safety-icon">
              <i class="fas fa-${getAdvisoryIcon(advisory.type)}"></i>
            </div>
            <div class="safety-info">
              <div class="safety-name">${advisory.type.charAt(0).toUpperCase() + advisory.type.slice(1)} Advisory</div>
              <div class="safety-details">${advisory.message}</div>
            </div>
          `;
          travelAdvisoriesList.appendChild(advisoryCard);
        });
      }
      
      // Get service icon
      function getServiceIcon(serviceType) {
        switch(serviceType) {
          case 'Medical': return 'hospital';
          case 'Police': return 'shield-alt';
          case 'Diplomatic': return 'landmark';
          case 'Information': return 'info-circle';
          default: return 'map-marker-alt';
        }
      }
      
      // Get advisory icon
      function getAdvisoryIcon(advisoryType) {
        switch(advisoryType) {
          case 'health': return 'heartbeat';
          case 'safety': return 'exclamation-triangle';
          case 'cultural': return 'users';
          default: return 'info-circle';
        }
      }
      
      // Generate packing checklist
      function generatePackingChecklist(analysis) {
        const tripType = analysis.tripType;
        const tripDuration = analysis.tripDuration;
        const weatherData = analysis.weatherData;
        const checklistGrid = document.getElementById('checklistGrid');
        
        checklistGrid.innerHTML = '';
        
        // Base items for all trips
        const baseItems = [
          'Identification',
          'Money/Credit Cards',
          'Phone & Charger',
          'Medications',
          'First Aid Kit'
        ];
        
        // Weather-specific items
        const weatherItems = [];
        if (weatherData.daily.precipitation_probability_max[0] > 30) {
          weatherItems.push('Umbrella', 'Waterproof Jacket');
        }
        if (weatherData.current.uv_index > 5) {
          weatherItems.push('Sunscreen', 'Sunglasses', 'Hat');
        }
        if (weatherData.current.temperature_2m < 15) {
          weatherItems.push('Warm Layers', 'Gloves');
        }
        if (weatherData.current.temperature_2m > 28) {
          weatherItems.push('Light Clothing', 'Extra Water');
        }
        
        // Activity-specific items
        const activityItems = getActivityItems(tripType);
        
        // Duration-specific items
        const durationItems = getDurationItems(tripDuration);
        
        // Combine all items
        const allItems = [...baseItems, ...weatherItems, ...activityItems, ...durationItems];
        
        // Add items to checklist
        allItems.forEach(item => {
          const checklistItem = document.createElement('div');
          checklistItem.className = 'checklist-item';
          checklistItem.innerHTML = `
            <i class="fas fa-check-circle checklist-icon"></i>
            <div class="checklist-name">${item}</div>
          `;
          checklistGrid.appendChild(checklistItem);
        });
      }
      
      // Get activity-specific items
      function getActivityItems(tripType) {
        switch(tripType) {
          case 'beach':
            return ['Swimwear', 'Beach Towel', 'Sandals', 'Beach Bag', 'Snorkel Gear'];
          case 'mountain':
            return ['Hiking Boots', 'Backpack', 'Water Bottle', 'Trail Map', 'Headlamp'];
          case 'boating':
            return ['Life Jacket', 'Water Shoes', 'Dry Bag', 'Fishing Gear', 'Seasickness Medication'];
          case 'safari':
            return ['Binoculars', 'Camera', 'Neutral-colored Clothing', 'Insect Repellent', 'Field Guide'];
          case 'city':
            return ['Comfortable Shoes', 'City Map', 'Guidebook', 'Daypack', 'Local Currency'];
          case 'photography':
            return ['Camera', 'Extra Batteries', 'Lenses', 'Tripod', 'Lens Cleaning Kit'];
          default:
            return [];
        }
      }
      
      // Get duration-specific items
      function getDurationItems(tripDuration) {
        switch(tripDuration) {
          case 'day':
            return ['Daypack', 'Snacks', 'Water Bottle'];
          case 'weekend':
            return ['Overnight Bag', 'Toiletries', 'Change of Clothes'];
          case 'week':
            return ['Luggage', 'Multiple Outfits', 'Travel Adapter'];
          case 'extended':
            return ['Large Luggage', 'Laundry Supplies', 'Entertainment'];
          default:
            return [];
        }
      }
      
      // Show error state
      function showErrorState(message) {
        const errorHTML = `
          <div class="error-state">
            <i class="fas fa-exclamation-triangle error-icon"></i>
            <h3>Something went wrong</h3>
            <p>${message}</p>
            <button class="form-btn" onclick="location.reload()">
              <i class="fas fa-redo"></i> Try Again
            </button>
          </div>
        `;
        
        // Create a temporary container to hold the error state
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = errorHTML;
        
        // Clear the dashboard and show error
        const dashboardCard = document.querySelector('.dashboard-card');
        dashboardCard.innerHTML = '';
        dashboardCard.appendChild(tempDiv.firstElementChild);
      }
    });
  </script>
</body>
</html>